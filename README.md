# ğŸ–¥ï¸ ë‚˜í™€ë¡œ ì„± ì§€í‚¤ê¸°

+ ì œí•œ ì‹œê°„ ë™ì•ˆ ëª°ë ¤ì˜¤ëŠ” ì ë“¤ì„ ì²˜ì¹˜í•˜ê³  ì„±ì„ ì§€í‚¤ëŠ” ì›í„°ì¹˜ ê²Œì„ ì…ë‹ˆë‹¤!
+ ëª°ë ¤ì˜¤ëŠ” ì ë“¤ì„ ì²˜ì¹˜í•˜ê³  60ì´ˆ ë™ì•ˆ ì„±ì„ ì§€í‚¤ì„¸ìš”!
+ ìŠ¤í‚¬ ë½‘ê¸°ë¥¼ í†µí•´ ìŠ¤í‚¬ì„ ì–»ìœ¼ì„¸ìš”!
+ ê°™ì€ ì†ì„±ì˜ ìŠ¤í‚¬ì„ ì¥ì°©í•´ì„œ ì ê³¼ ì‹¸ìš°ì„¸ìš”!
<br/>

## ğŸ“½ï¸ í”„ë¡œì íŠ¸ ì†Œê°œ
 - ê²Œì„ ì´ë¦„ : ë‚˜í™€ë¡œ ì„± ì§€í‚¤ê¸°
 - í”Œë«í¼ : Android / Web
 - ì¥ë¥´ : 2D í•˜ì´í¼ìºì£¼ì–¼ ë””íœìŠ¤ ì•¡ì…˜ ì•„ì¼€ì´ë“œ
 - ê°œë°œ ê¸°ê°„ : 24.03.18 ~ 24.04.19
 - í”„ë¡œì íŠ¸ ìœ í˜• : ê°œì¸
<br/>

## âš™ï¸ Environment

- `Unity 2022.3.23f1`
- **IDE** : Visual Studio 2019, MonoDevelop
- **VCS** : Git (GitHub Desktop)
- **Envrionment** : Android / Web
- **Resolution** : 1920 x 1080 `FHD`
<br/>

## â–¶ï¸ ê²Œì„ ìŠ¤í¬ë¦°ìƒ·

<p align="center">
  <img src="https://github.com/JaeMinNa/CastleDefence2D/assets/149379194/3f839016-1a7c-4c2d-ac4e-a139f88fdbee" width="49%"/>
  <img src="https://github.com/JaeMinNa/CastleDefence2D/assets/149379194/2da0e46b-8a1d-449d-badf-f9cfe755f746" width="49%"/>
</p>
<p align="center">
  <img src="https://github.com/JaeMinNa/CastleDefence2D/assets/149379194/512405f5-034a-48bf-b8e9-bcbd533b567f" width="49%"/>
  <img src="https://github.com/JaeMinNa/CastleDefence2D/assets/149379194/6388d81d-0f0e-45b2-9bbd-c1090f8dbf23" width="49%"/>
</p>
<p align="center">
  <img src="https://github.com/JaeMinNa/CastleDefence2D/assets/149379194/43425d4d-311c-4cb3-a646-a9def38e52c1" width="49%"/>
  <img src="https://github.com/JaeMinNa/CastleDefence2D/assets/149379194/1107054e-59a9-4e60-b3d2-9096fe7f9cd5" width="49%"/>
</p>
<br/>

## ğŸ”³ ì™€ì´ì–´ í”„ë ˆì„
![image](https://github.com/JaeMinNa/CastleDefence2D/assets/149379194/e4e6cb5f-0754-496b-8b76-ab81b40c503b)
![image](https://github.com/JaeMinNa/CastleDefence2D/assets/149379194/946f7205-8b3d-4dd3-bf66-185bb4ddce80)


## ğŸ§© í´ë¼ì´ì–¸íŠ¸ êµ¬ì¡°

### GameManager
![image](https://github.com/JaeMinNa/CastleDefence2D/assets/149379194/82d943a9-0013-4c2d-a27c-590612208480)

### Enemy
![image](https://github.com/JaeMinNa/CastleDefence2D/assets/149379194/751c8abd-d84f-4597-b9d7-98ec8e6784eb)


## âœï¸ êµ¬í˜„ ê¸°ëŠ¥

### 1. ìƒíƒœ íŒ¨í„´ êµ¬í˜„
<img src="https://github.com/JaeMinNa/CastleDefence2D/assets/149379194/76266ccb-1def-47b6-adbb-e9cc4239b6f7" width="50%"/>

#### êµ¬í˜„ ì´ìœ 
- ë‹¤ì–‘í•œ ìƒíƒœë¥¼ ê°€ì§„ Playerì™€ Enemy ì›€ì§ì„ êµ¬í˜„
- ëŠì„ì—†ì´ ë…ë¦½ì ìœ¼ë¡œ í–‰ë™í•´ì•¼ í•¨
- ìœ ì—°í•œ ìƒíƒœ ê´€ë¦¬ë¡œ í•„ìš”ì— ë”°ë¼ ìƒíƒœë¥¼ ì¶”ê°€í•˜ê±°ë‚˜ ìˆ˜ì •ì´ ê°€ëŠ¥í•´ì•¼ í•¨

#### êµ¬í˜„ ë°©ë²•
- IState ì¸í„°í˜ì´ìŠ¤ : êµ¬ì²´ì ì¸ ìƒíƒœ í´ë˜ìŠ¤ë¡œ ì—°ê²°í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •
```C#
public interface IEnemyState
{
    void Handle(EnemyController controller);
}
``` 
â€‹
- Context ìŠ¤í¬ë¦½íŠ¸ : í´ë¼ì´ì–¸íŠ¸ê°€ ê°ì²´ì˜ ë‚´ë¶€ ìƒíƒœë¥¼ ë³€ê²½í•  ìˆ˜ ìˆë„ë¡ ìš”ì²­í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ ì •ì˜
```C#
public void Transition()
{
    CurrentState.Handle(_enemyController);
}

public void Transition(IEnemyState state)
{
    CurrentState = state;
    CurrentState.Handle(_enemyController);
}
```
â€‹
- State ìŠ¤í¬ë¦½íŠ¸ : ê° Stateë¥¼ ì •ì˜, State ë³€ê²½ ì¡°ê±´ ì„¤ì •
```C#
// Startë¬¸ê³¼ ë™ì¼í•˜ê²Œ ì‚¬ìš©
public void Handle(EnemyController enemyController)
{
    if (!_enemyController)
        _enemyController = enemyController;

    Debug.Log("Idle ìƒíƒœ ì‹œì‘");   
    _idleTime = 3f;
    _time = 0;

    StartCoroutine(COUpdate());
}

// Updateë¬¸ê³¼ ë™ì¼í•˜ê²Œ ì‚¬ìš©
IEnumerator COUpdate()
{
  while (true)
  {
  	// ê°ê°ì˜ ìƒíƒœ ë³€í™˜ ì¡°ê±´ ì„¤ì •
	if(_enemyController.Ishit)
    	{
		_enemyController.HitStart();
		break;
	}
	if(_enemyController.IsAttack)
	{
		_enemyController.AttackStart();
		break;
	}
    
      yield return null;
  }
}
```
<br/>

### 2. ë¡±í´ë¦­ êµ¬í˜„
<img src="https://github.com/JaeMinNa/CastleDefence2D/assets/149379194/c8ad82a6-fc10-4605-ab7f-51881792969d" width="50%"/>

#### êµ¬í˜„ ì´ìœ 
- ë²„íŠ¼ í´ë¦­ ì‹œ, Playerì˜ ë°©í–¥ ì „í™˜ê³¼ ìŠ¤í‚¬ ì‚¬ìš©ì„ ìœ„í•´

#### êµ¬í˜„ ë°©ë²•
- Event Trigger ì¶”ê°€
<img src="https://github.com/JaeMinNa/CastleDefence2D/assets/149379194/cb78fd39-4f33-44ce-bfe8-83270f0f34e6" width="50%"/>

- Pointer Up, Pointer Down ì¶”ê°€
<img src="https://github.com/JaeMinNa/CastleDefence2D/assets/149379194/3ea32d49-2703-488b-b375-1f12fed014f2" width="50%"/>

- ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±
```C#
public float minClickTime = 1; // ìµœì†Œ í´ë¦­ì‹œê°„
private float _clickTime; // í´ë¦­ ì¤‘ì¸ ì‹œê°„
private bool _isClick; // í´ë¦­ ì¤‘ì¸ì§€ íŒë‹¨ 

// ë²„íŠ¼ í´ë¦­ì´ ì‹œì‘í–ˆì„ ë•Œ
public void ButtonDown()
{
	_isClick = true;
}

// ë²„íŠ¼ í´ë¦­ì´ ëë‚¬ì„ ë•Œ
public void ButtonUp()
{
	_isClick = false;

	if (_clickTime >= minClickTime)
	{
		Debug.Log("ìŠ¤í‚¬ ë°œë™!");
	}
}

private void Update()
{
	if (_isClick)
	{
		_clickTime += Time.deltaTime;
	}
	else
	{
		_clickTime = 0;
	}
}
```

- ë²„íŠ¼ ì—°ê²°
<img src="https://github.com/JaeMinNa/CastleDefence2D/assets/149379194/e4c67f5b-08eb-4b59-86e6-00d52e57e5c3" width="50%"/>
<br/>
<br/>

### 3. ObjectPool êµ¬í˜„
<img src="https://github.com/JaeMinNa/CastleDefence2D/assets/149379194/d578aac4-d786-4216-acca-ad1abbc2cfe1" width="50%"/>

#### êµ¬í˜„ ì´ìœ 
- ë¯¸ë¦¬ ìƒì„±í•œ í”„ë¦¬íŒ¹ì„ íŒŒê´´í•˜ì§€ ì•Šê³ , ì¬ì‚¬ìš©í•´ì„œ ìµœì í™”ë¥¼ ìœ„í•´
- í”„ë¦¬íŒ¹ì˜ Instantiate, Destroy í•¨ìˆ˜ ì‚¬ìš©ì„ ì¤„ì´ê¸° ìœ„í•´
- Enemy, Skill, Item ë“± ìƒì„±ê³¼ íŒŒê´´ë¥¼ ë°˜ë³µí•˜ëŠ” í”„ë¦¬íŒ¹ì— ì ìš©

#### êµ¬í˜„ ë°©ë²•
- ObjectPoolManagerë¡œ ObjectPoolë“¤ì„ ê´€ë¦¬
- Sizeë§Œí¼ ë¯¸ë¦¬ í”„ë¦¬íŒ¹ì„ ìƒì„±í•˜ê³ , ì„ ì…ì„ ì¶œì¸ Queue ìë£Œêµ¬ì¡°ë¡œ ìˆœì°¨ì ìœ¼ë¡œ SetActive(true) ì‹¤í–‰
```C#
public GameObject SpawnFromPool(string tag)
{
    if (!PoolDictionary.ContainsKey(tag))
        return null;

    GameObject obj = PoolDictionary[tag].Dequeue();
    PoolDictionary[tag].Enqueue(obj);

    return obj;
}
```
<br/>

### 4. SpawnSystem êµ¬í˜„
<img src="https://github.com/JaeMinNa/CastleDefence2D/assets/149379194/22d48439-f734-463e-b729-c700c63a21c0" width="50%"/>

#### êµ¬í˜„ ì´ìœ 
- ì¸ìŠ¤í™í„° ì°½ì—ì„œ Stage ë³„, ì ì˜ ì¢…ë¥˜ì™€ Spawn ì‹œê°„ì„ ì„¤ì •í•˜ê¸° ìœ„í•´
- ê°ê° Stage ë§ˆë‹¤, ì§ì ‘ ë‚œì´ë„ë¥¼ ì„¤ì •í•˜ê¸° ìœ„í•´

#### êµ¬í˜„ ë°©ë²•
- SpawnSystem ìƒì„±
<img src="https://github.com/JaeMinNa/CastleDefence2D/assets/149379194/b14f46a4-933a-4f6d-ac97-cabd09477da4" width="50%"/>

- ì¸ìŠ¤í™í„° ì°½ì—ì„œ Stage ì •ë³´ë¥¼ ì…ë ¥í•  ìˆ˜ ìˆë„ë¡, structë¥¼ Serializableë¡œ ì§ë ¬í™”
<img src="https://github.com/JaeMinNa/CastleDefence2D/assets/149379194/f2ff9c46-db91-4570-baa5-34b5674559d2" width="50%"/>

```C#
[System.Serializable]
public struct StageInfo
{
	public int Stage;
	public string[] enemys; // enemy + ìƒì„±ë˜ëŠ” ì‹œê°„ ì…ë ¥ ex) "Snail 5"
}
public List<StageInfo> Stages;
```
<br/>

- ì…ë ¥í•œ Stage ì •ë³´ë¥¼ Split í•¨ìˆ˜ë¡œ ë¬¸ìì—´ì„ ìë¥´ê³  ì  ëœë¤ Spawn
```C#
private void Start()
{
	_currentStage = GameManager.I.DataManager.GameData.Stage;
	for (int i = 0; i < Stages[_currentStage - 1].enemys.Length; i++)
	{
		string[] words = Stages[_currentStage - 1].enemys[i].Split(' ');
		_enemy = words[0];
		_spawnTime = int.Parse(words[1]);
		
		StartCoroutine(COSpawnEnemy(_enemy, _spawnTime));
	}
}

IEnumerator COSpawnEnemy(string enemy, int time)
{
	while (true)
	{
		yield return new WaitForSeconds(time);
		
		int random = Random.Range(0, 2);

		if (random == 0) GameManager.I.ObjectPoolManager.ActivePrefab(enemy, _spawnLeft.position);
		else GameManager.I.ObjectPoolManager.ActivePrefab(enemy, _spawnRigth.position);
	}
}
```
<br/>

### 5. Skill êµ¬í˜„
<img src="https://github.com/JaeMinNa/CastleDefence2D/assets/149379194/f72e2a16-0a57-4236-8bd4-0fbe8b81e356" width="50%"/>

#### êµ¬í˜„ ì´ìœ 
- Melee, Ranged, Area Skill êµ¬í˜„

#### êµ¬í˜„ ë°©ë²•
- Melee Skill ê³µê²© ì‹œ, AttackColliderë¥¼ SetActive(true)í•´ì„œ ì  ë°ë¯¸ì§€ ì ìš©
<img src="https://github.com/JaeMinNa/CastleDefence2D/assets/149379194/904a0dae-134a-4fe4-8e45-1f945244f163" width="50%"/>

```C#
private void OnTriggerEnter2D(Collider2D collision)
{
	if(collision.CompareTag("Enemy"))
	{
	    Vector2 _dir = collision.transform.position - _playerController.transform.position;
	    collision.transform.GetComponent<EnemyController>().Ishit = true;
	
	    if(transform.CompareTag("MeleeCollider"))
	    {
		collision.transform.GetComponent<EnemyController>().Hp -= _playerController.Atk;
	    }
	}
}
```
<br/>

- Ranged Skill, Areak Skill ê³µê²© ì‹œ, Physics2D.OverlapCircleAllë¡œ ì£¼ìœ„ ë²”ìœ„ì˜ ì½œë¼ì´ë”ë¥¼ ê°ì§€í•´ì„œ ì  ë°ë¯¸ì§€ ì ìš©

```C#
private void Targetting()
{
	int layerMask = (1 << _layerMask);  // Layer ì„¤ì •
	_targets = Physics2D.OverlapCircleAll(transform.position - new Vector3(0, 2, 0), 2f, layerMask);
	
	for (int i = 0; i < _targets.Length; i++)
	{
	    _targets[i].gameObject.GetComponent<EnemyController>().Hp -= _player.GetComponent<PlayerController>().Atk;
	}
}
```
<br/>

- Areak Skill ê³µê²© ì‹œ, Interval ì´ˆ ê°„ê²©ìœ¼ë¡œ Count ìˆ˜ ë§Œí¼ ë°˜ë³µ

```C#
IEnumerator COShootAreaSkill(SkillData areaSkillData)
{
	int count = 0;
	while (true)
	{
	    count++;
	    GameManager.I.ObjectPoolManager.ActivePrefab(areaSkillData.Tag, transform.position);
	
	    if (count == areaSkillData.Count) break;
	    yield return new WaitForSeconds(areaSkillData.Interval);
	}
}
```
<br/>

- Areak Skill ê³µê²© ì‹œ, ì£¼ìœ„ ë²”ìœ„ ë‚´, ëœë¤ìœ¼ë¡œ ìƒì„±í•˜ê³  ì•„ë˜ë¡œ ì´ë™í•˜ë„ë¡ êµ¬í˜„

```C#
private void Start()
{
	float random = Random.Range(_player.transform.position.x - _areaSkillData.Range, _player.transform.position.x + _areaSkillData.Range);
	_startPos = new Vector3(random, 10f, 0);
	transform.position = _startPos;
}

private void Update()
{
    transform.position += new Vector3(0, -_areaSkillData.Speed, 0) * Time.deltaTime;
}
```
<br/>

### 6. í™”ì‚´ í¬ë¬¼ì„  ìš´ë™ êµ¬í˜„
<img src="https://github.com/JaeMinNa/CastleDefence2D/assets/149379194/4d1cd27c-466f-4028-a8d7-31bf6e131532" width="50%"/>

#### êµ¬í˜„ ì´ìœ 
- ì„±ì˜ ì¢Œìš° ìë™ ê³µê²©ì„ ìœ„í•´
- ì¤‘ë ¥ì˜ ì˜í–¥ì„ ë°›ëŠ” ìì—°ìŠ¤ëŸ¬ìš´ í™”ì‚´ êµ¬í˜„ì„ ìœ„í•´

#### êµ¬í˜„ ë°©ë²•
- í™”ì‚´ì— Rigdbodyì™€ Collider ì¶”ê°€
<img src="https://github.com/JaeMinNa/CastleDefence2D/assets/149379194/7cc79412-ae01-4f19-8bc6-ce8fc8c4fdc8" width="50%"/>

- ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±

```C#
public float _power;

private void Start()
{
	_rigidbody.AddForce(transform.right * _power, ForceMode2D.Impulse);
}

private void Update()
{
	transform.right = _rigidbody.velocity;
}
```
<br/>

### 7. ì¸ë²¤í† ë¦¬ êµ¬í˜„
<img src="https://github.com/JaeMinNa/CastleDefence2D/assets/149379194/003244f9-06c6-4b2b-8425-c0736d6f2e14" width="50%"/>

#### êµ¬í˜„ ì´ìœ 
- ë³´ìœ í•œ Skillì˜ ëª©ë¡ì„ í™•ì¸í•˜ê¸° ìœ„í•´

#### êµ¬í˜„ ë°©ë²•
- Scroll Viewì™€ Grid Layout Groupì„ ì¶”ê°€
<img src="https://github.com/JaeMinNa/CastleDefence2D/assets/149379194/cafe7146-32eb-4a68-85b9-7e8350698158" width="50%"/>

- Inventory ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±

```C#
private void UpdateMeleeSKillInventory()
{
	// Inventory ì´ˆê¸°í™”
	for (int i = 0; i < _meleeSlotContent.transform.childCount; i++)
	{
		_skillInventorySlot = _meleeSlotContent.transform.GetChild(i).GetComponent<SkillInventorySlot>();
		_skillInventorySlot.SkillEmpty();
	}

	// Inventory Slot
	for (int i = 0; i < _skills.Count; i++)
	{
		_meleeSlotContent.transform.GetChild(i).transform.GetChild(0).GetComponent<Image>().sprite = Resources.Load<Sprite>(_skills[i].IconPath);
		_skillInventorySlot = _meleeSlotContent.transform.GetChild(i).GetComponent<SkillInventorySlot>();
		_skillInventorySlot.SkillText(_skills[i]);
	}
}
```
<br/>

### 8. ë½‘ê¸° êµ¬í˜„
<img src="https://github.com/JaeMinNa/CastleDefence2D/assets/149379194/483c5efc-7427-4d66-89db-670cc19b0517" width="50%"/>  

#### êµ¬í˜„ ì´ìœ 
- Skillì˜ Rank ë³„, ë½‘ê¸° í™•ë¥  ì ìš©ì„ ìœ„í•´

#### êµ¬í˜„ ë°©ë²•
- Random.Range í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ 1 ~ 100ì˜ ìì—°ìˆ˜ ì¤‘, ëœë¤í•˜ê²Œ ê°€ì§€ê³ ì™€ì„œ ë­í¬ì— ë”°ë¼ ë½‘ê¸° í™•ë¥ ì„ ì„¤ì •
- Random.Range í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ 0 ~ 2 ì˜ ìì—°ìˆ˜ ì¤‘, ëœë¤í•˜ê²Œ ê°€ì§€ê³ ì™€ì„œ Melee, Ranged, Area ìŠ¤í‚¬ì„ ê²°ì •
- whileë¬¸ì„ ì‚¬ìš©í•´ì„œ ê²°ì •ëœ Rankê°€ ë‚˜ì˜¬ë•Œê¹Œì§€ ë°˜ë³µí•˜ë„ë¡ êµ¬í˜„
- S Rank : 10%, A Rank : 25%, B Rank : 65% ì ìš©

```C#
public void SkillIInfoButton()
{
int length = _dataWrapper.SkillData.Length;
int random1 = Random.Range(0, 3); // Skill Type
int random2 = Random.Range(1, 101); // Rank

if(random1 == 0) // Melee
{
    while (true)
    {
	int random3 = Random.Range(0, length);
	if (_dataWrapper.SkillData[random3].Type != SkillData.SkillType.Melee) continue;

	if(_dataWrapper.SkillData[random3].Rank == SkillData.SkillRank.S)
	{
	    if (random2 >= 1 && random2 <= 10)
	    {
		_getSkillData = _dataWrapper.SkillData[random3];
		break;
	    }
	    else continue;
	}
	else if(_dataWrapper.SkillData[random3].Rank == SkillData.SkillRank.A)
	{
	    if (random2 >= 11 && random2 <= 35) // A
	    {
		_getSkillData = _dataWrapper.SkillData[random3];
		break;
	    }
	    else continue;
	}
	else
	{
	    if (random2 >= 36 && random2 <= 100) // B
	    {
		_getSkillData = _dataWrapper.SkillData[random3];
		break;
	    }
	    else continue;
	}
    }
}
```
<br/>

  
### 9. Json ë°ì´í„° ì €ì¥ ê¸°ëŠ¥ êµ¬í˜„
<img src="https://github.com/JaeMinNa/CastleDefence2D/assets/149379194/12a93236-5aec-475e-8d3f-9fac1e874fc1" width="50%"/> 

#### êµ¬í˜„ ì´ìœ 
- ê²Œì„ ë°ì´í„°ë¥¼ ìë™ìœ¼ë¡œ ì €ì¥í•˜ëŠ” ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ê¸° ìœ„í•´
- ìœ ë‹ˆí‹°ì—ì„œ JSON Utility í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•´ì„œ ì˜¤ë¸Œì íŠ¸ ë°ì´í„°ë¥¼ ì‰½ê²Œ ë‹¤ë£° ìˆ˜ ìˆê¸° ë•Œë¬¸ì—

#### êµ¬í˜„ ë°©ë²•
- ì¸ìŠ¤í™í„° ì°½ì—ì„œ ë°ì´í„°ë¥¼ í™•ì¸ ë˜ëŠ” ìˆ˜ì •ì´ ê°€ëŠ¥í•˜ë„ë¡ ë°ì´í„° classë¥¼ Serializableë¡œ ì§ë ¬í™”

```C#
using System.IO;

[System.Serializable]
public class GameData
{
    [Header("GameData")]
    public int Satge = 1;
    public int Coin = 0;
    public int SkillDrawCount = 0;

    [Header("Sound")]
    public float BGMVolume = 0;
    public float SFXVolume = 0;
}
```
<br/>

- ë°ì´í„°ë¥¼ ì €ì¥, ë¶ˆëŸ¬ì˜¤ê¸° í•˜ëŠ” í•¨ìˆ˜ ì‘ì„±

```C#
[ContextMenu("To Json Data")] // ì»´í¬ë„ŒíŠ¸ ë©”ë‰´ì— ì•„ë˜ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” To Json Data ë¼ëŠ” ëª…ë ¹ì–´ê°€ ìƒì„±ë¨
void SaveGameDataToJson()
{
	// Androidë‚˜ WebGL í”Œë«í¼ì—ì„œëŠ” persistentDataPath ê²½ë¡œë¥¼ ì‚¬ìš©í•´ì•¼ í•¨
	if (Application.platform == RuntimePlatform.WebGLPlayer || Application.platform == RuntimePlatform.Android)
	{
	    string jsonData = JsonUtility.ToJson(GameData, true);
	    string path = Path.Combine(Application.persistentDataPath, "GameData.json");
	    File.WriteAllText(path, jsonData);
	}
	// ìœ ë‹ˆí‹° ì—ë””í„°
	else
	{
	    string jsonData = JsonUtility.ToJson(GameData, true);
	    string path = Path.Combine(Application.dataPath, "GameData.json");
	    File.WriteAllText(path, jsonData);
	}
}

[ContextMenu("From Json Data")]
void LoadGameDataFromJson()
{
	// Androidë‚˜ WebGL í”Œë«í¼ì—ì„œëŠ” persistentDataPath ê²½ë¡œë¥¼ ì‚¬ìš©í•´ì•¼ í•¨
	if(Application.platform == RuntimePlatform.WebGLPlayer || Application.platform == RuntimePlatform.Android)
	{
	    string path = Path.Combine(Application.persistentDataPath, "GameData.json");
	    string jsonData = File.ReadAllText(path);
	    GameData = JsonUtility.FromJson<GameData>(jsonData);
	}
	// ìœ ë‹ˆí‹° ì—ë””í„°
	else
	{
	    string path = Path.Combine(Application.dataPath, "GameData.json");
	    string jsonData = File.ReadAllText(path);
	    GameData = JsonUtility.FromJson<GameData>(jsonData);
	}
}
```
<br/>

- ì¸ìŠ¤í™í„° ì°½ì—ì„œ ìˆ˜ì •ëœ ë°ì´í„° ì €ì¥, ë¶ˆëŸ¬ì˜¤ê¸°
<img src="https://github.com/JaeMinNa/CastleDefence2D/assets/149379194/3cb23f65-b22e-428b-af06-df8b4e58907d" width="50%"/> 
<br/>

### 10. Admob ë³´ìƒí˜• ê´‘ê³  êµ¬í˜„
<img src="https://github.com/JaeMinNa/CastleDefence2D/assets/149379194/05fd840c-4f81-4f16-910b-cda374eb84e0" width="50%"/> 

#### êµ¬í˜„ ì´ìœ 
- ìœ ì €ê°€ ëˆì„ ì§€ë¶ˆí•˜ì§€ ì•Šì•„ë„ ê´‘ê³ ë¥¼ ì‹œì²­í•˜ë©´ Coinì„ ì–»ê±°ë‚˜, ê²Œì„ì„ ë” í”Œë ˆì´ í•  ìˆ˜ ìˆëŠ” ê¸°íšŒë¥¼ ì–»ê²Œí•˜ê¸° ìœ„í•´
- ìœ ì €ë“¤ì´ ê´‘ê³ ë¥¼ ì‹œì²­í•¨ìœ¼ë¡œì¨, ê²Œì„ì˜ ìˆ˜ìµí™”ë¥¼ ì‹¤í˜„í•˜ê¸° ìœ„í•´

#### êµ¬í˜„ ë°©ë²•
- Google Admobì—ì„œ ë³´ìƒí˜• ê´‘ê³  ìƒì„±
- Unity pluginì„ ì„¤ì¹˜ í›„, í”„ë¡œì íŠ¸ì— Import
- í…ŒìŠ¤íŠ¸ IDì™€ ê´‘ê³  IDë¥¼ ì ìš©í•´ì„œ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±

```C#
private void start()
{
	#if UNITY_ANDROID
		if (IsTestMode) _adUnitId = "ca-app-pub-3940256099942544/5224354917"; // í…ŒìŠ¤íŠ¸ìš© ID
		else _adUnitId = ""; // ê´‘ê³  ID
	#elif UNITY_IPHONE
		_adUnitId = "ca-app-pub-3940256099942544~1458002511"; // í…ŒìŠ¤íŠ¸ìš© ID
	#else
		_adUnitId = "unused";
	#endif

MobileAds.Initialize((InitializationStatus initStatus) => { });

public void LoadRewardedAd()
{
	if (_rewardedAd != null)
	{
	    _rewardedAd.Destroy();
	    _rewardedAd = null;
	}

	var adRequest = new AdRequest();

	RewardedAd.Load(_adUnitId, adRequest, (RewardedAd ad, LoadAdError error) =>
	{
		if (error != null || ad == null)
		{
		    Debug.LogError("Rewarded ad failed to load an ad " +
				   "with error : " + error);
		    return;
		}

		Debug.Log("Rewarded ad loaded with response : " + ad.GetResponseInfo());

		_rewardedAd = ad;
		RegisterEventHandlers(_rewardedAd);
		ShowRewardedAd();
	});
}

public void ShowRewardedAd()
{
	if (_rewardedAd != null && _rewardedAd.CanShowAd())
	{
	    _rewardedAd.Show((Reward reward) =>
	    {
		// ê´‘ê³  ë³´ìƒ ì…ë ¥
	    });
	}
}

private void RegisterEventHandlers(RewardedAd ad)
{
	ad.OnAdPaid += (AdValue adValue) => { };
	ad.OnAdImpressionRecorded += () => { };
	ad.OnAdClicked += () => { };
	ad.OnAdFullScreenContentOpened += () => { };
	ad.OnAdFullScreenContentClosed += () => { };
	// ê´‘ê³  ë¶ˆëŸ¬ì˜¤ê¸°ë¥¼ ì‹¤íŒ¨í–ˆì„ ë•Œ
	ad.OnAdFullScreenContentFailed += (AdError error) =>
	{
	    LoadRewardedAd();
	};
}
```
<br/>

## ğŸ’¥ íŠ¸ëŸ¬ë¸” ìŠˆíŒ…

### 1. Input Systemì„ ì´ìš©í•œ Player ì´ë™ ê°œì„ 
<img src="https://github.com/JaeMinNa/Ocean_Bloom/assets/149379194/401b8466-c112-43e6-ab26-1a410670b324" width="50%"/>

#### Input í´ë˜ìŠ¤ë¡œ Player ì´ë™ êµ¬í˜„
- ê°„í¸í•˜ê³  ì§ê´€ì ìœ¼ë¡œ êµ¬í˜„ ê°€ëŠ¥
- Update ë¬¸ì—ì„œ ë§¤ í”„ë ˆì„ ì‹¤í–‰í•˜ê¸° ë•Œë¬¸ì— ì„±ëŠ¥ì— ì˜í–¥
```C#
private void FixedUpdate()
{
	float moveHorizontal = Input.GetAxis("Horizontal");
	float moveVertical = Input.GetAxis("Vertical");
	
	Vector3 movement = new Vector3(moveHorizontal, 0f, moveVertical);
	_rigidbody.AddForce(movement * speed);
}
```

#### Input Systemìœ¼ë¡œ ê°œì„ 
- ì…ë ¥ ì´ë²¤íŠ¸ì— ëŒ€í•œ ë°”ì¸ë”© ë° ì²˜ë¦¬ë¥¼ ì‰½ê²Œ êµ¬ì„±
- Updateë¬¸ì—ì„œ ë§¤ í”„ë ˆì„ ì‹¤í–‰í•  í•„ìš”ê°€ ì—†ìŒ
- ë‹¤ì–‘í•œ ì…ë ¥ ì¥ì¹˜ë¥¼ ì§€ì›
```C#
public void OnMoveInput(InputAction.CallbackContext context)
{
	if (context.phase == InputActionPhase.Performed)
	{
	    _curMovementInput = context.ReadValue<Vector2>();
	}
	else if (context.phase == InputActionPhase.Canceled)
	{
	    _curMovementInput = Vector2.zero;
	}
}

private void Move()
{
	Vector3 dir = transform.forward * _curMovementInput.y + transform.right * _curMovementInput.x;
	dir *= MoveSpeed;
	dir.y = _rigidbody.velocity.y;
	
	_rigidbody.velocity = dir;
}
```

#### ê²°ê³¼
- ë³µì¡í•œ ì…ë ¥ ì‹œìŠ¤í…œì´ë‚˜ ë‹¤ì¤‘ ì…ë ¥ ì¡°í•©ì„ ìœ ì—°í•˜ê²Œ ì²˜ë¦¬
<br/>

### 2. Physics.Raycastë¥¼ ì´ìš©í•œ ì´ê¸° êµ¬í˜„ ê°œì„ 
<img src="https://github.com/JaeMinNa/Ocean_Bloom/assets/149379194/d736e5a7-8aca-4f6b-b4af-56039f537bb6" width="50%"/>

#### ì´ì•Œ í”„ë¦¬íŒ¹ì„ ìƒì„±í•´ì„œ ì´ê¸° êµ¬í˜„
- ì‹¤ì œì™€ ê°™ì€ ì´ì•Œ ì†ë„, íƒ„ë„í•™ ë“± ì ìš© ê°€ëŠ¥
- ì‹¤ì œì™€ ìœ ì‚¬í•˜ê²Œ ì ìš©í•˜ëŠ” ê²ƒì´ ì–´ë ¤ì›€
- ì ì ˆí•œ ë©”ëª¨ë¦¬ ê´€ë¦¬ ë°©ë²• í•„ìš”
```C#
private void Fire()
{
	Instantiate(bullet, transform.position, Quaternion.identity);
}
```

#### Physics.Raycastë¡œ ê°œì„ 
- ì´ì•Œ í”„ë¦¬íŒ¹ì„ ìƒì„±í•  í•„ìš”ê°€ ì—†ìŒ
- ì¦‰ê°ì ìœ¼ë¡œ ëŒ€ìƒì˜ ì •ë³´ë¥¼ ì½ì–´ ì˜¬ ìˆ˜ ìˆìŒ
- ë³„ë„ì˜ ë©”ëª¨ë¦¬ ê´€ë¦¬ ë°©ë²•ì´ í•„ìš” ì—†ìŒ
```C#
if (Physics.Raycast(Camera.main.transform.position, Camera.main.transform.forward, out _hitInfo, 50f))
{
	Debug.Log(_hitInfo.transform.name);
}
```

#### ê²°ê³¼
- ì´ˆë‹¹ í”„ë ˆì„ ê°œì„  (63 FPS â†’ 73 FPS)
<p align="center">
  <img src="https://github.com/JaeMinNa/Ocean_Bloom/assets/149379194/5b4e21fc-eaef-4272-986f-ec634f077708" width="49%"/>
  <img src="https://github.com/JaeMinNa/Ocean_Bloom/assets/149379194/dee9851e-ed68-4e00-80ca-6c9db30fc122" width="49%"/>
</p>
<br/>

### 3. ObjectPoolì„ ì´ìš©í•œ ì´ê¸° íƒ„í”¼ êµ¬í˜„ ê°œì„ 

#### í”„ë¦¬íŒ¹ ìƒì„±, íŒŒê´´ë¡œ ì´ê¸° íƒ„í”¼ êµ¬í˜„
- ê°„ë‹¨í•˜ê³  ì§ê´€ì ìœ¼ë¡œ êµ¬í˜„ ê°€ëŠ¥
- ë°˜ë³µì ì¸ í”„ë¦¬íŒ¹ ìƒì„±, ì‚­ì œë¡œ ì„±ëŠ¥ ì €í•˜ ì´ˆë˜
- ì ì ˆí•œ ë©”ëª¨ë¦¬ ê´€ë¦¬ ë°©ë²• í•„ìš”
```C#
private void Fire()
{
	Instantiate(_bulletEffectObj, transform.position, Quaternion.identity);
}
```

#### ObjectPoolë¡œ ê°œì„ 
- í”„ë¦¬íŒ¹ ìƒì„±, íŒŒê´´ë¥¼ í•˜ì§€ ì•ŠìŒ
- ê°ì²´ë¥¼ ë¯¸ë¦¬ ìƒì„±í•´ì„œ ì¬ì‚¬ìš© â†’ ë©”ëª¨ë¦¬ ìµœì í™” ê°€ëŠ¥

##### ObjectPoolManager
```C#
public void GunEffect(string poolName ,Vector3 startPosition, Quaternion rotation)
{
	_bulletEffectObj = ObjectPool.SpawnFromPool(poolName);
	
	_bulletEffectObj.transform.position = startPosition;
	_bulletEffectObj.transform.rotation = rotation;
	//RangedAttackController attackController = obj.GetComponent<RangedAttackController>();
	//attackController.InitializeAttack(direction, attackData, this);
	
	_bulletEffectObj.SetActive(true);
	StartCoroutine(COGunEffectInactive());
}

IEnumerator COGunEffectInactive()
{
	GameObject obj = _bulletEffectObj;
	
	yield return new WaitForSeconds(0.5f);
	obj.SetActive(false);
}
```

##### ObjectPool
```C#
public GameObject SpawnFromPool(string tag)
{
	if (!PoolDictionary.ContainsKey(tag))
	    return null;
	
	GameObject obj = PoolDictionary[tag].Dequeue();
	PoolDictionary[tag].Enqueue(obj);
	
	return obj;
}
```
![image](https://github.com/JaeMinNa/Ocean_Bloom/assets/149379194/558554b0-f1c7-4bd5-b0d0-334c68ce8041)

#### ê²°ê³¼
- ì´ˆë‹¹ í”„ë ˆì„ ê°œì„  (50 FPS â†’ 76 FPS)
<p align="center">
  <img src="https://github.com/JaeMinNa/Ocean_Bloom/assets/149379194/e02299d0-c341-4ce3-9006-d945f44c5431" width="49%"/>
  <img src="https://github.com/JaeMinNa/Ocean_Bloom/assets/149379194/3b3c0f06-0d57-4f9f-ad4a-7f0070b47a9e" width="49%"/>
</p>
<br/>

### 4. ìƒíƒœ íŒ¨í„´ì„ ì´ìš©í•œ ì ê³¼ ë™ë£Œ êµ¬í˜„
<img src="https://github.com/JaeMinNa/Ocean_Bloom/assets/149379194/86cd872d-3d7e-4dba-94c8-5e29f8b92a86" width="50%"/>

#### ë¬¸ì œ ìƒí™©
- ì ê³¼ ë™ë£Œì˜ ë…ë¦½ì ì¸ ì›€ì§ì„ì„ êµ¬í˜„í•˜ê¸° ìœ„í•œ ë°©ë²•ì´ í•„ìš”

#### í•´ê²° ë°©ì•ˆ
##### ì¡°ê±´ë¬¸ê³¼ ìŠ¤ìœ„ì¹˜ë¬¸ ì‚¬ìš©
- ê°„ë‹¨í•˜ê³  ì§ê´€ì ìœ¼ë¡œ êµ¬í˜„ ê°€ëŠ¥
- í–‰ë™ì´ ë§ë‹¤ë©´ ì½”ë“œê°€ ë³µì¡í•´ì§
##### ìƒíƒœ íŒ¨í„´
- ìƒˆë¡œìš´ ìƒíƒœ ì¶”ê°€ê°€ ì‰¬ì›€
- í™•ì¥ì„±ì´ ìš©ì´
  
#### ì˜ê²¬ ê²°ì •
##### ìƒíƒœ íŒ¨í„´ìœ¼ë¡œ êµ¬í˜„
- íŠ¹ì • ì¡°ê±´ì— ë”°ë¼ ê°ê° ë‹¤ë¥¸ í–‰ë™ì„ í•  ìˆ˜ ìˆìŒ
- íŠ¹ì • í–‰ë™ì„ ì¶”ê°€í•´ë„ ìœ ì§€ ê´€ë¦¬ê°€ ìš©ì´
<br/>

### 5. Physics.OverlapSphereë¥¼ ì´ìš©í•œ Targetting êµ¬í˜„
<img src="https://github.com/JaeMinNa/Ocean_Bloom/assets/149379194/dbfc5b0a-af38-477d-a89c-63363e19549d" width="50%"/>

#### ë¬¸ì œ ìƒí™©
- ë™ë£Œì™€ ì ì˜ ë‹¨ì²´ ì „íˆ¬ ìš”ì†Œë¥¼ ìœ„í•´ Targetting ë°©ë²•ì´ í•„ìš”

#### í•´ê²° ë°©ì•ˆ
##### BoxColliderë¡œ IsTrigger ë²”ìœ„ ì„¤ì •
- ê°„ë‹¨í•˜ê²Œ êµ¬í˜„ ê°€ëŠ¥
##### Physics.OverlapSphereë¥¼ ì‚¬ìš©
<img src="https://github.com/JaeMinNa/Ocean_Bloom/assets/149379194/3187c4ed-2000-44df-b310-79ad0154658f" width="50%"/>

- íŠ¹ì • ë²”ìœ„ ë‚´ì˜ ì ì´ë‚˜ ë™ë£Œ íŒë³„ ê°€ëŠ¥
- ì½”ë£¨í‹´ í•¨ìˆ˜ë¡œ ì¼ì • ì‹œê°„ ë°˜ë³µí•´ì„œ ì‚¬ìš©í•´ì•¼ í•¨

```C#
private void Targetting()
{
	int layerMask = (1 << _layerMask);	// Layer ì„¤ì •
	_targets = Physics.OverlapSphere(transform.position, 50f, layerMask);
}
```
 
#### ì˜ê²¬ ê²°ì •
##### Physics.OverlapSphereë¡œ êµ¬í˜„
- BoxCollider ì‚¬ìš© ì‹œ, ì´ê¸° êµ¬í˜„ì—ì„œ ì‚¬ìš©í•œ Physics.Raycastê°€ BoxColliderë¥¼ ë¨¼ì € ì¸ì‹í•´ì„œ ì ì„ ì¸ì‹í•  ìˆ˜ ì—†ìŒ
- ë²”ìœ„ ë‚´ì—ì„œ ê°€ì¥ ê°€ê¹Œìš´ ì ì´ë‚˜ ë™ë£Œë¥¼ ì§€ì • ê°€ëŠ¥
<br/>

### 6. PlayerPrefsë¥¼ ì´ìš©í•œ ë°ì´í„° ì €ì¥ ê¸°ëŠ¥ êµ¬í˜„
<img src="https://github.com/JaeMinNa/Ocean_Bloom/assets/149379194/a1088497-fab3-4f63-87fd-7a9184a5a1b2" width="50%"/>

#### ë¬¸ì œ ìƒí™©
- Playerì˜ ì •ë³´ì™€ ë°°ì˜ ìœ„ì¹˜ë¥¼ ì €ì¥í•  ìˆ˜ ìˆëŠ” ê°„ë‹¨í•œ ì €ì¥ ë°©ë²• í•„ìš”

#### í•´ê²° ë°©ì•ˆ
##### PlayerPrefs ì‚¬ìš©
- ìœ ë‹ˆí‹°ì—ì„œ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ìœ¼ë¡œ ì§ê´€ì ìœ¼ë¡œ ê°„ë‹¨í•˜ê²Œ ì‚¬ìš© ê°€ëŠ¥

```C#
public void DataSave()
{
	// Player ì •ë³´ ì €ì¥
	PlayerPrefs.SetFloat("SaveHp", _playerConditions.Health.CurValue);
	PlayerPrefs.SetInt("SaveCurrentBullet", _playerController.GunController.CurrentGun.CurrentBulletCount);
	PlayerPrefs.SetInt("SaveCoin", _playerController.CurrentCoin);
}

public void DataLoad()
{
	// Player ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸°
	_playerConditions.Health.CurValue = PlayerPrefs.GetFloat("SaveHp");
	_playerController.GunController.CurrentGun.CurrentBulletCount = PlayerPrefs.GetInt("SaveCurrentBullet");
	_playerController.CurrentCoin = PlayerPrefs.GetInt("SaveCoin") ;
}
```

##### ì§ë ¬í™” ë° íŒŒì¼ ì €ì¥ ì‚¬ìš©
- ì•ˆì „í•˜ê³  ì†ë„ê°€ ë§¤ìš° ë¹ ë¦„
##### ë°ì´í„°ë² ì´ìŠ¤ ì‚¬ìš©
- ëŒ€ê·œëª¨ ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³  ê´€ë¦¬ì— ì í•©

#### ì˜ê²¬ ê²°ì •
##### PlayerPrefsë¡œ êµ¬í˜„
- ê°„ë‹¨í•œ ì •ë³´ë§Œ ì €ì¥í•˜ë©´ ë˜ê¸° ë•Œë¬¸ì— ë¡œì»¬ ì €ì¥ì´ ë§ë‹¤ê³  íŒë‹¨
- ê°„ë‹¨í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ë‹¨ìˆœí•œ ê²Œì„ ì§„í–‰ë„ëŠ” PlayerPrefsë¡œ ì¶©ë¶„íˆ êµ¬í˜„ ê°€ëŠ¥
<br/>


## ğŸ‘©â€ğŸ‘¦â€ğŸ‘¦ ìœ ì € í…ŒìŠ¤íŠ¸
 - ìœ ì € í…ŒìŠ¤íŠ¸ ê¸°ê°„ : 24.02.21 ~ 24.02.28
<br/>

<img src="https://github.com/JaeMinNa/Ocean_Bloom/assets/149379194/e23a933a-2f65-4024-881a-20619a0d3ac5" width="50%"/>
<br/>
<br/>



## ğŸ“‹ í”„ë¡œì íŠ¸ íšŒê³ 
### ì˜í•œ ì 
 - ìœ ì € í…ŒìŠ¤íŠ¸ë¥¼ í†µí•´, í”¼ë“œë°±ì„ ë°›ê³  ìˆ˜ì • ì‘ì—… ì§„í–‰
 - ObjectPoolì„ í†µí•´, ìµœì í™” ì§„í–‰
 - ìƒíƒœ íŒ¨í„´ êµ¬í˜„
<br/>

### í•œê³„
- ì „ì²´ì ì¸ ìµœì í™” ì§„í–‰ ë¶€ì¡±
- ë°°, íŒŒë„ ìœ ë£Œ ì—ì…‹ì˜ ì‚¬ìš©ë²•ì„ ì œëŒ€ë¡œ ìˆ™ì§€ ëª»í•¨
- ë°©ì¹˜í˜• ë³´ìƒ ê¸°ëŠ¥ì˜ ë¡œì»¬ ì‹œê°„ ì €ì¥
- ê²Œì„ì˜ ëª©ì ì„±, ì»¨í…ì¸  ë¶€ì¡±ìœ¼ë¡œ í¥ë¯¸ê°€ ë–¨ì–´ì§
- PlayerPrefsë¥¼ ì´ìš©í•œ ì €ì¥ì˜ ë³´ì™„ì´ í•„ìš”
<br/>

### ì†Œê°
ìœ ë£Œ ì—ì…‹ ì‚¬ìš©, ìµœì í™” ì§„í–‰, ìœ ì € í”¼ë“œë°± ê²½í—˜ ë“± ì²˜ìŒìœ¼ë¡œ ì‹œë„í•œ ê²ƒë“¤ì´ ë§ì•„ì„œ ì˜ë¯¸ê°€ ê¹Šì€ í”„ë¡œì íŠ¸ì˜€ìŠµë‹ˆë‹¤. ìµœì í™” ì§„í–‰ì—ì„œëŠ” ì™„ë²½í•˜ë‹¤ê³  ë³¼ ìˆ˜ëŠ” ì—†ì§€ë§Œ, ë‹¤ìŒ í”„ë¡œì íŠ¸ì—ì„œ ë”ìš± ì˜í•  ìˆ˜ ìˆì„ ê±°ë¼ëŠ” ìì‹ ê°ì„ ê°€ì§ˆ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ì¡°ë“¤ì— ë¹„í•´ì„œ ì¸ì› ìˆ˜ê°€ ë§ì´ ë¶€ì¡±í–ˆì§€ë§Œ, ê·¸ë§Œí¼ ì •ë§ ë§ì€ ê²ƒë“¤ì„ ë°°ìš¸ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.
  
